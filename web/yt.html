<!DOCTYPE html>
<html lang="en">

<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>AS UTUBE</title>
 <!-- Bootstrap CSS -->
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
 <!-- Bootstrap Icons -->
 <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
 <!-- Google Fonts -->
 <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
 <!-- Custom CSS -->
 <style>
  :root {
      --gradient-1: #ff6b6b;
      --gradient-2: #4ecdc4;
      --bg-color: #ffffff;
      --text-color: #212529;
      --card-bg: #ffffff;
      --header-bg: linear-gradient(135deg, var(--gradient-1), var(--gradient-2));
      --shadow-color: rgba(0, 0, 0, 0.1);
  }
  
  [data-bs-theme="dark"] {
      --bg-color: #1a1a1a;
      --text-color: #f8f9fa;
      --card-bg: #2d2d2d;
      --header-bg: linear-gradient(135deg, #2c3e50, #3498db);
      --shadow-color: rgba(255, 255, 255, 0.1);
  }
  
  body {
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
  }
  
  .video-card {
      margin-bottom: 20px;
      transition: all 0.3s;
      cursor: pointer;
      border: none;
      box-shadow: 0 4px 6px var(--shadow-color);
      background-color: var(--card-bg);
  }
  
  .video-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px var(--shadow-color);
  }
  
  .video-thumbnail {
      height: 200px;
      object-fit: cover;
      border-radius: 8px 8px 0 0;
  }
  
  #playerContainer {
      width: 100%;
      height: 400px;
  }
  
  .hero-header {
      background: var(--header-bg);
      padding: 2rem 0;
      margin-bottom: 2rem;
      box-shadow: 0 4px 6px var(--shadow-color);
  }
  
  .brand-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.5rem;
      letter-spacing: 2px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
  }
  
  .search-type-btn {
      transition: all 0.3s;
  }
  
  .theme-toggle {
      position: absolute;
      right: 20px;
      top: 20px;
      border: none;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      transition: all 0.3s;
  }
  
  [data-bs-theme="dark"] .theme-toggle {
      background: rgba(0, 0, 0, 0.1);
      color: var(--text-color);
  }
  
  @media (max-width: 768px) {
      #playerContainer {
          height: 250px;
      }
      
      .brand-title {
          font-size: 2rem;
      }
  
      .theme-toggle {
          position: static;
          margin-top: 1rem;
      }
      
      .header-content {
          flex-direction: column;
      }
  }
 </style>
</head>

<body>
 <!-- Header -->
 <header class="hero-header">
  <div class="container text-center position-relative">
   <div class="header-content d-flex justify-content-between align-items-center">
    <h1 class="brand-title text-white mb-0">AS UTUBE</h1>
    <button class="theme-toggle" id="themeToggle">
     <i class="bi bi-moon-fill d-none"></i>
     <i class="bi bi-sun-fill"></i>
    </button>
   </div>
  </div>
 </header>

 <!-- Search Bar -->
 <div class="container my-4">
  <div class="row">
   <div class="col-md-8 offset-md-2">
    <div class="input-group">
     <div class="input-group-prepend">
      <select class="form-select search-type-btn" id="searchType">
       <option value="video">Videos</option>
       <option value="channel">Channels</option>
       <option value="playlist">Playlists</option>
      </select>
     </div>
     <input type="text" id="searchInput" class="form-control" placeholder="Search YouTube...">
     <button class="btn btn-primary search-type-btn" onclick="handleSearch()">
      <i class="bi bi-search"></i> Search
     </button>
    </div>
   </div>
  </div>
 </div>

 <!-- Video Container -->
 <div class="container">
  <div class="row" id="videoContainer"></div>
 </div>

 <!-- Load More Button -->
 <div class="container my-4 text-center">
  <button class="btn btn-primary search-type-btn" id="loadMore" onclick="loadMore()">Load More</button>
 </div>

 <!-- Video Player Modal -->
 <div class="modal fade" id="videoModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-xl">
   <div class="modal-content">
    <div class="modal-header">
     <h5 class="modal-title" id="videoTitle"></h5>
     <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
    </div>
    <div class="modal-body p-0">
     <div id="playerContainer"></div>
    </div>
   </div>
  </div>
 </div>

 <!-- Bootstrap JS and Popper.js -->
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 <!-- YouTube IFrame API -->
 <script src="https://www.youtube.com/iframe_api"></script>

 <!-- YouTube API Script -->
 <script>
  // Theme handling
  const themeToggle = document.getElementById('themeToggle');
  const storedTheme = localStorage.getItem('theme');
  
  // Set initial theme
  if (storedTheme) {
      document.body.setAttribute('data-bs-theme', storedTheme);
      toggleIcons(storedTheme);
  }
  
  // Toggle theme
  themeToggle.addEventListener('click', () => {
      const currentTheme = document.body.getAttribute('data-bs-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      
      document.body.setAttribute('data-bs-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      toggleIcons(newTheme);
  });
  
  function toggleIcons(theme) {
      const moonIcon = themeToggle.querySelector('.bi-moon-fill');
      const sunIcon = themeToggle.querySelector('.bi-sun-fill');
      
      if (theme === 'dark') {
          moonIcon.classList.remove('d-none');
          sunIcon.classList.add('d-none');
      } else {
          moonIcon.classList.add('d-none');
          sunIcon.classList.remove('d-none');
      }
  }
  
  // Original YouTube API Script
  const API_KEY = 'AIzaSyAcqHZh-8pZr1H5Kdq5Hwa0jVl9Yc9jupg';
  let nextPageToken = '';
  let currentSearchTerm = '';
  let currentSearchType = 'video';
  let player;
  
  function onYouTubeIframeAPIReady() {
      player = new YT.Player('playerContainer', {
          height: '100%',
          width: '100%',
          events: {
              'onReady': onPlayerReady
          }
      });
  }
  
  function onPlayerReady(event) {
      // Player ready callback
  }
  
  async function fetchContent(searchTerm = '', pageToken = '', searchType = 'video') {
      let url;
      if (searchTerm) {
          url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=${searchType}&q=${encodeURIComponent(searchTerm)}&maxResults=12&regionCode=IN&key=${API_KEY}&pageToken=${pageToken}`;
      } else {
          url = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&chart=mostPopular&regionCode=IN&maxResults=12&key=${API_KEY}&pageToken=${pageToken}`;
      }
  
      try {
          const response = await fetch(url);
          const data = await response.json();
          nextPageToken = data.nextPageToken || '';
          return data.items || [];
      } catch (error) {
          console.error('Error fetching content:', error);
          return [];
      }
  }
  
  function displayContent(items, isSearch = false, searchType = 'video') {
      const container = document.getElementById('videoContainer');
      
      items.forEach(item => {
          const snippet = item.snippet;
          let contentCard;
  
          if (searchType === 'video') {
              const videoId = isSearch ? item.id.videoId : item.id;
              contentCard = createVideoCard(snippet, videoId);
          } else if (searchType === 'channel') {
              contentCard = createChannelCard(snippet, item.id.channelId);
          } else if (searchType === 'playlist') {
              contentCard = createPlaylistCard(snippet, item.id.playlistId);
          }
  
          container.innerHTML += contentCard;
      });
  }
  
  function createVideoCard(snippet, videoId) {
      return `
          <div class="col-md-3 col-sm-6">
              <div class="card video-card" onclick="playVideo('${videoId}', '${snippet.title.replace(/'/g, "\\'")}')">
                  <img src="${snippet.thumbnails.medium.url}" class="card-img-top video-thumbnail" alt="${snippet.title}">
                  <div class="card-body">
                      <h5 class="card-title">${snippet.title}</h5>
                      <p class="card-text text-muted">${snippet.channelTitle}</p>
                  </div>
              </div>
          </div>
      `;
  }
  
  function createChannelCard(snippet, channelId) {
      return `
          <div class="col-md-3 col-sm-6">
              <div class="card video-card" onclick="window.open('https://www.youtube.com/channel/${channelId}', '_blank')">
                  <img src="${snippet.thumbnails.medium.url}" class="card-img-top video-thumbnail" alt="${snippet.title}">
                  <div class="card-body">
                      <h5 class="card-title">${snippet.title}</h5>
                      <p class="card-text text-muted">Channel</p>
                  </div>
              </div>
          </div>
      `;
  }
  
  function createPlaylistCard(snippet, playlistId) {
      return `
          <div class="col-md-3 col-sm-6">
              <div class="card video-card" onclick="window.open('https://www.youtube.com/playlist?list=${playlistId}', '_blank')">
                  <img src="${snippet.thumbnails.medium.url}" class="card-img-top video-thumbnail" alt="${snippet.title}">
                  <div class="card-body">
                      <h5 class="card-title">${snippet.title}</h5>
                      <p class="card-text text-muted">Playlist</p>
                  </div>
              </div>
          </div>
      `;
  }
  
  function playVideo(videoId, title) {
      const modal = new bootstrap.Modal(document.getElementById('videoModal'));
      document.getElementById('videoTitle').textContent = title;
      
      if (player && typeof player.loadVideoById === 'function') {
          player.loadVideoById(videoId);
      }
      
      modal.show();
  }
  
  window.onload = async function() {
      const videos = await fetchContent();
      displayContent(videos);
  };
  
  async function handleSearch() {
      currentSearchTerm = document.getElementById('searchInput').value;
      currentSearchType = document.getElementById('searchType').value;
      const items = await fetchContent(currentSearchTerm, '', currentSearchType);
      document.getElementById('videoContainer').innerHTML = '';
      displayContent(items, true, currentSearchType);
      document.getElementById('loadMore').style.display = nextPageToken ? 'block' : 'none';
  }
  
  async function loadMore() {
      const items = await fetchContent(currentSearchTerm, nextPageToken, currentSearchType);
      displayContent(items, true, currentSearchType);
      document.getElementById('loadMore').style.display = nextPageToken ? 'block' : 'none';
  }
  
  document.getElementById('searchInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') handleSearch();
  });
  
  document.getElementById('videoModal').addEventListener('hide.bs.modal', () => {
      if (player && typeof player.stopVideo === 'function') {
          player.stopVideo();
      }
  });
 </script>
</body>
</html>
